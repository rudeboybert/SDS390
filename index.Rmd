---
title: "SDS390: Ecological Forecasting"
author: "Albert Y. Kim"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
---

<style>
h1{font-weight: 400;}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo=TRUE, 
  message=FALSE, 
  warning=FALSE, 
  eval=TRUE, 
  fig.width=16/2, 
  fig.height=9/2
)
library(tidyverse)
library(lubridate)
library(stringr)
library(forcats)
library(moderndive)

# Formating packages:
library(knitr)
library(kableExtra)
library(scales)

# Etc
library(here)
library(patchwork)

# Set seed value of random number generator to get "replicable" random numbers.
set.seed(76)

# For "copy code" button for code chunks
klippy::klippy()

# Student list for group making
students <- c("Candy", "Emma S.", "Emma K.", "Haley", "Lauren", "Olivia", "Serena", "Sophie", "Starry", "Nidhi")
```



***



# Schedule 

<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQw8rrRUpbMRdy01pwUDw4C65XK1ekgQZWUeWN66L5KrAwtXuWMuo1EEk-2qULxsYPforSIAIsEI1dY/pubhtml?gid=1373353942&amp;single=true&amp;widget=true&amp;headers=false" width="100%" height="600"></iframe>

<!--
{target="_blank"}
-->



<!--
Feedback
* Connect ecological content to course better
* Consider starting course on time? Solicit feedback
* Ramp up GitHub for MP3
* Set up dedicated zoom room for course that auto-records
* Better ways to leverage group work and small class

* Assign one personal reading
* Sheet & flashlight trick
* Shiny app on parameters
* Logistic regression is a special case of generalized logistic regression function
-->



***


# Lec 05: Tue 9/15 {#Lec05}

## Videos

### 1. Models and parameter estimation

Given an assumed model $y = f(\vec{x}) + \epsilon$, you want an fitted model $\widehat{y} = \widehat{f}(\vec{x})$. To do this, you need to do *parameter estimation*. [PDF of chalk talk](static/chalk_talks/Lec05.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pAf1JAGzM-E" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>



## Class meeting time

1. Announcements
    1. Say hello to Emma K.
    1. In course schedule, I posted readings and lecture topics for next week (more on Thu 9/17).
    1. MP1: I'll give feedback by Thursday's lecture, likely this afternoon.
1. [Plan for the semester](https://docs.google.com/document/d/1PeQXPsnxe6ZJjiBGBXD3dRfTKNETKMQpzIJUSWgTYr0/edit?usp=sharing){target="_blank"}
1. Breakout rooms
    1. Plan for the semester and course format
    1. Video: model parameters
    1. MP2 questions
1. [Link](https://smith.zoom.us/rec/share/oRGM5exNswi3Svq6bfq3j3mxyYXzl2ELSTlGZ5RqIdQmkYOCl4cYDywpe6rLj8QO.lB4yeBtWJRZSv5C_?startTime=1600179202000){target="_blank"} to video recording.




***



# Lec 04: Thu 9/10 {#Lec04}

## Videos

### 1. GitHub branches and pull requests

Using the "playground" repo [here](https://github.com/390-2020-09-Fall/SCBI-ForestGEO-Data){target="_blank"}, which is a separate copy of the Smithsonian Conservation Biology Institute (SCBI) ForestGEO Data found [here](https://github.com/SCBI-ForestGEO/SCBI-ForestGEO-Data){target="_blank"}. [PDF of chalk talk](static/chalk_talks/Lec04.pdf).

**Update on Thu 9/10 8:30am**: I changed "ownership" of the repository from my personal GitHub "rudeboybert" to the class GitHub Organization ["390-2020-09-Fall"](https://github.com/390-2020-09-Fall). I've added a link to this organization in the top-left of this webpage menubar.


</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DHpNuxPgiQY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

### 2. Conducting a census of trees

In the Battell Woods, Middlebury, VT, USA.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/z3kNVHm7R0I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>



## Class meeting time

1. Announcements:
    1. See update I added today about Video 1. 
    1. For all video chalk talks, I'll post the PDF on the webpage. Also I'll work on improving my handwriting!
    1. Note that I added the two missing lines of code to the Lec03 code on auto-correlation functions.
1. Intros
1. Lingering questions from Lec03?
1. Breakout rooms:
    1. Questions about Lec04 Videos
    1. Data collection reflection: Write down anything that crossed your mind as you collected this data. Ex: what difficulties, what questions, did anything from my video not apply in your case?
    1. ForestGEO reading: What do you think are some organizational goals of the ForestGEO **network**?
1. Discuss what's next week.
1. [Link](https://drive.google.com/file/d/15vszRIZQ1qEpqiQbeXjJDApfDG-ZVQ2n/view?usp=sharing){target="_blank"} to video recording.


## For next week

### 1. Readings

The readings for next week are posted in the above Schedule Google Sheet. Anything below the orange line is still TBD.  

1. **Albert's tips for Shiny reading**: Run the code! The best way to learn how to use tools is to learn by doing.
1. **Albert's tips for Ecological Forecasting reading**: This book is pitched at a higher level than for undergraduates. However let's keep with the "some is better than none" philosophy by dedicating at least 30 minutes to reading and *setting a timer*.
    1. Read the synopsis at the start of each chapter
    1. Read the key concepts at the back of each chapter
    1. Scan through the figures and tables
    1. Most importantly tho, look at the clock and keep moving! *Done is better than perfect!*
    1. If you have more time or are more curious, then iterate through the above steps again, again, again, ...

```{r, echo=FALSE, fig.align="center"}
include_graphics("static/images/MVP.png")
```


### 2. MP2

Ask any questions in the `#mp2` channel on Slack.

**a) Race to the first data visualization** Create a first visualization of the 2018 SCBI ForestGEO census. For MP3, you'll be making a Shiny interactive version of this visualization.

1. Re-watch Lec04 Video 2 about tree censuses 
1. *"Numbers are numbers, but data has context"*: Look at map of the four corners of the [SCBI site](https://www.google.com/maps/d/edit?mid=1QYcZhzmRASjCqFyCiraxosBmMcWrEeg7&usp=sharing){target="_blank"}. 
1. Clone the playground version of the [SCBI-ForestGEO-Data](https://github.com/390-2020-09-Fall/SCBI-ForestGEO-Data) repo
1. Find the relevant `.csv` file in the `tree_main_census/` folder
1. Load the `.csv` in R


**b) Submit via GitHub branch and pull request**

1. Create a new branch just like in Lec04 Video 1.
1. Create your visualization in a file `390/YOURFIRSTNAME_YOURLASTNAME.Rmd`
1. Make all commits
1. Submit a pull request




***



# Lec 03: Tue 9/8 {#Lec03}

## Videos

### 1. Dendrobands

One way to measure a tree's dbh is using dendrobands (6:00). 

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OT2FPiMwGcQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

```{r, include = FALSE, eval = FALSE}
# Code used at end of video. Need to run
# growth_phenology/RScripts/SCBI_growth_phenology.R first
plot <- all_stems %>%
  as_tibble() %>%
  filter(tag %in% c(082422, 202215, 172202)) %>%
  mutate(sp = case_when(
    sp == "litu" ~ "tulip poplar",
    sp == "qual" ~ "white oak",
    sp == "quru" ~ "red oak"
  )) %>%
  unite("date", c(year, month, day), sep = "-") %>%
  mutate(date = ymd(date)) %>%
  filter(date >= ymd("2015-01-01")) %>%
  ggplot(aes(x=date, y=measure, col = sp, group = tag)) +
  geom_line() +
  labs(x = "Date of measurement", y = "Diameter in cm", col = "species") +
  coord_cartesian(xlim = c(ymd("2015-01-01"), ymd("2020-08-01")))
plot

library(plotly)
weather <- weatherdata %>%
  filter(DATE >= ymd("2015-01-01")) %>%
  mutate(month = floor_date(DATE, unit = "months")) %>%
  group_by(month) %>%
  dplyr::summarize(`Average max temp` = mean(TMAX)) %>%
  ggplot(aes(x = month, y = `Average max temp`)) +
  geom_line() +
  labs(x = "Date", y = "Temperature", title = "Average monthly maximum temperature")
ggplotly(weather)

plot +
  geom_vline(xintercept = as.Date("2017-07-01"), linetype = "dashed") +
  geom_vline(xintercept = as.Date("2020-07-01"), linetype = "dashed")
```


### 2. Time series {#Lec03-Video2}

Chalk talk on exploratory data analysis for time series plots (14:24). **Update after Lec03**: [PDF of chalk talk](static/chalk_talks/Lec03.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oy-eVRkQUeE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

Corresponding code:

```{r, eval = FALSE, class.source="klippy"}
# Lec03 Code
library(tidyverse)
library(tsibble)
library(lubridate)
library(fpp3)

weatherdata <-
  read_csv("https://rudeboybert.github.io/SDS390/static/data/NCDC_NOAA_precip_temp.csv") %>%
  mutate(
    # Convert to variable of type date
    date = dmy(DATE), 
    # This will be used for the group_by() below
    month = floor_date(date, unit = "month"),
    # Using special function from fpp package to define yearmonth units
    month = yearmonth(month)
  ) %>% 
  group_by(month) %>% 
  summarize(TMAX_avg = mean(TMAX, na.rm = TRUE), PRCP_avg = mean(PRCP, na.rm = TRUE)) %>% 
  # Convert to tsibble = time series tibble data type
  as_tsibble(index = month) 

# FPP3 2.2 Fig 2.1
weatherdata %>% autoplot(TMAX_avg)

# FPP3 2.4 Fig 2.4
weatherdata %>% gg_season(TMAX_avg, labels = "both")

# FPP3 2.5 Fig 2.5 
weatherdata %>% gg_subseries(TMAX_avg)

# FPP3 2.7 Fig 2.16 
weatherdata %>% gg_lag(TMAX_avg, lags = 1:12)

# Update after Lec03: FPP3 2.8 Fig 2.17
weatherdata %>% ACF(TMAX_avg) %>% autoplot()
```




## Class meeting time

1. Announcements
    1. More introductions: name/pronoun, year/major, city you're currently in, name a few things you will do this semester for self-care.
    1. Started scheduling office hours in [syllabus](syllabus.html).
    1. We'll be using the [3rd online edition of FPP](https://otexts.com/fpp3/){target="_blank"} (I originally linked to the 2nd edition).
1. Check in on [MP1](#MP1)
1. Set up our workspace for the semester:
    1. Open RStudio
    1. Create a new RStudio project called `SDS390`
    1. Create a new `.R` script or `.Rmd` and call it `lecture_notes`
    1. Copy the code for any lecture into `lecture_notes`. For today: the above `# Lec03 Code`
1. Breakout rooms: A designated group leader will create a Slack DM with all members, but not Albert. They will take notes and then speak on behalf of the group. Discuss
    1. What is the goal of analysis hinted in Video 1? Questions?
    1. Do you have questions about Video 2 on time series?
    1. Do you have any feedback/comments about lecture format?
    1. Questions about MP1?
1. [Link](https://smith.zoom.us/rec/share/msdCameUcJtJV4W6_TllvNOYGCYdU72iUSIFMPXxW0oF4zYv6G25uVGJdjHQ3BRb.MdQFuvpLLtgaxvUU){target="_blank"} to video recording.


***



# Lec 02: Thu 9/3 {#Lec02}

## Videos

Note: I will do my best to post any videos the day before lecture at 6pm eastern.

### 1. Data collection activity... in the field!

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/U83hZCTRxPA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>


## Class meeting time

1. "Chalk talk": Introduction to GitHub terminology. I encourage you to write along: [*I’m not writing it down to remember it later, I’m writing it down to remember it now.*](https://twitter.com/jack/status/369882367093002242){target="_blank"}
1. Demo of what you'll be doing for MP1. 
1. [Link](https://smith.zoom.us/rec/share/r1TRECCVTK1AST0fjikBWNFziM1id-VtREbZM2mLsuv_sS4N5NkKCqrzOqh76BiS.cj7NMRvilB29J2yz){target="_blank"} to video recording.



## For next week

### 1. Readings

The readings for next week are posted in the above Schedule Google Sheet. Anything below the orange line is still TBD.  

1. To access all journal articles from Smith Libraries, you will need to be logged into Smith's Virtual Private Network [(instructions on how to set this up)](https://www.smith.edu/its/tara/networking/vpn.html){target="_blank"}. 
1. Tips on reading. Take the *minimally viable product* approach. In other words, a completed imperfect reading is better than an incomplete "perfect" reading.

```{r, echo=FALSE, fig.align="center"}
include_graphics("static/images/MVP.png")
```

    
### 2. MP1 {#MP1}

Ask any questions in the `#mp1` channel on Slack.

**a) Data collection**

1. To the best of your abilities, replicate my DBH data collection in the video.
1. You will submit your answers in this [Google Form](https://docs.google.com/forms/d/e/1FAIpQLSeJ28eWWThINaXKWE2uvOFuDL2YiMVPheSa47ZRrtp8Q10W1Q/viewform){target="_blank"}.
1. You may need help identifying the tree's species. To this end, take a few photos of the tree and if possible the leaves. 


**b) First GitHub edits**

1. Create an [ORCID](https://orcid.org/){target="_blank"}, which you can think of as a social security number for research. Mine is [0000-0001-7824-306X](https://orcid.org/0000-0001-7824-306X){target="_blank"}.
1. *Clone* the following *repo* *locally* onto your computer using RStudio: my *forked* copy of Prof. Ben Baumer's [`macleich` R package](https://github.com/rudeboybert/macleish){target="_blank"}. 
1. *Pull* the repo to update it with any changes.
1. Edit the `DESCRIPTION` file by adding yourself as a contributor like I did.
1. *Commit* your changes and then *push* them.
1. You may need to check out these [notes](https://rudeboybert.github.io/SDS192/PS.html#1_github_component){target="_blank"} on getting started linking GitHub to RStudio.



***



# Lec 01: Tue 9/1

## Class meeting time

1. Introductions: name, pronoun, year, major, city you're currently in, name a few things you will do this semester for self-care.
1. Announcement from the [Statistical & Data Sciences Coalition of Color (SDSCC)](https://docs.google.com/presentation/d/1trAXeX9FHCHiMk5iFTN14TEmK8tXbRHfY5WdmNGChVc/edit#slide=id.g93874104fe_0_5){target="_blank"}
1. Go over syllabus
1. What is forecasting? From [FPP 3.5](https://otexts.com/fpp2/prediction-intervals.html){target="_blank"}:
```{r, echo=FALSE}
include_graphics("https://otexts.com/fpp2/fpp_files/figure-html/googforecasts2-1.png")
```
1. Discussion topic: Name four variables about a tree that both (1) are easily measurable in the field while (2) capture the most information about it.
1. [Link](https://smith.zoom.us/rec/share/v8pUE6rz_HlIWLPo6huEQ594T9T-aaa81ikX-fVfz00jHE5Ns0-sumdQni9hSU2V){target="_blank"} to video recording (required password on Slack in `#announcements`).


## Videos

I will post a ~20min video lecture by Wednesday afternoon eastern time. This is why we are starting synchronous discussions 25 minutes later than scheduled. 

1. "Chalk talk" on GitHub. I encourage you to not just passively watch, but also actively write. [Field Notes'](https://fieldnotesbrand.com/){target="_blank"} slogan is *I'm not writing it down to remember it later, I'm writing it down to remember it now.*
1. Data collection activity... in the field!



***


