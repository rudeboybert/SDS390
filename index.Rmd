---
title: "SDS390: Ecological Forecasting"
author: "Albert Y. Kim"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
---

<style>
h1{font-weight: 400;}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo=TRUE, 
  message=FALSE, 
  warning=FALSE, 
  eval=TRUE, 
  fig.width=16/2, 
  fig.height=9/2
)
library(tidyverse)
library(lubridate)
library(stringr)
library(forcats)
library(moderndive)

# Formating packages:
library(knitr)
library(kableExtra)
library(scales)

# Etc
library(here)
library(patchwork)
library(fpp3)

# Set seed value of random number generator to get "replicable" random numbers.
set.seed(76)

# For "copy code" button for code chunks
klippy::klippy()

# Student list for group making
students <- c("Candy", "Emma S.", "Emma K.", "Haley", "Lauren", "Olivia", "Serena", "Sophie", "Starry", "Nidhi")
```



***



# Schedule 

<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQw8rrRUpbMRdy01pwUDw4C65XK1ekgQZWUeWN66L5KrAwtXuWMuo1EEk-2qULxsYPforSIAIsEI1dY/pubhtml?gid=1373353942&amp;single=true&amp;widget=true&amp;headers=false" width="100%" height="600"></iframe>

<!--
{target="_blank"}
-->


<!--

Feedback:

* Connect ecological content to course better
* Better ways to leverage group work and small class


Topic ideas:

* Sheet & flashlight trick
* Permutation test (like bootstrap resampling)

-->



***



# Lec 10: Thu 10/1 {#Lec10}

## Videos

### 1. The Anatomy of a GitHub Pull Request

Learning more about GitHub Pull Requests as well as GitHub Issues using this [example](https://github.com/rudeboybert/forestecology/pull/37){target="_blank"}.

</br>
<center>
<div style="position: relative; padding-bottom: 56.25%; height: 0;"><iframe src="https://www.loom.com/embed/f4090c33caa5424eb3eb3d136dfa2987" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe></div>
</center>
</br>



### 2. ~~Time series decompositions & statistics~~ ES&P Presentation	

Watch my [presentation](https://smith.zoom.us/rec/share/qCAT70076QjI1FsPeDW0Rja9ev-iunwsrEyqVJVW-27gDrKTggw7QYKUYfNgyLeB.dx0K3Ygv81KXuHfA){target="_blank"} to the Environmental Science & Policy program, from 14:22 to 24:53. Password is on Slack.



## Class meeting time

1. Mini-projects
    1. Once PR's for any MP are approved, I'll enter your grade in moodle
    1. I gave feedback for MP3 on Shiny apps this week. Be sure to make requested changes and commit/push.
1. Breakout rooms: 
    1. GitHub pull requests and version control
    1. Growth as a proxy for carbon


## For next week

### 1. Readings

1. **FPP**: I moved today's FPP Ch 3-4 discussion to Tuesday. We'll have a single FPP Ch 5 discussion then.
1. **Podcast**: [(Link)](https://www.npr.org/2020/06/02/867691497/migration-isnt-crisis-it-s-the-solution-science-writer-says){target="_blank"} The roots of Linnean classification of species and how this influences our notion of "belonging" and "place", and thus our notion of "migration."


### 2. MP5 {#MP5}

Model selection as guided by $R^2_{adj}$ and $AIC$. Everything you need to this MP was covered in Lec09. Two scenarios:

1. Teaching evals data
    1. Interaction model vs
    1. Parallel slopes model
1. Maple trees in the BigWoods Michigan Forest
    1. Distinguish between competitor species
    1. Do not distinguish



***



# Lec 09: Tue 9/29 {#Lec09}

## Videos

### 1. Model selection

Recall our comparison of two models for interspecies competition from [Lec07](#Lec07). Which model should we select? 

```{r, echo=FALSE, out.width="49%", out.height="20%", fig.cap="Two models for the effect of competitor biomass.", fig.show='hold', fig.align='center'}
knitr::include_graphics(c("static/images/competition_1.png", "static/images/competition_2.png"))
``` 

Model selection attempts to balance (1) goodness-of-fit (how well a model fits points) and (2) model complexity. These two quantities are **inversely related**. Using example data from [ModernDive Chapter 6.3.1](https://moderndive.com/6-multiple-regression.html#model-selection){target="_blank"}, we discuss two numerical methods for selecting between (1) parallel slopes and (2) interaction regression models:

1. R-squared adjusted: $R^2_{adj} = 1 - \frac{n-1}{n - (k+1)}(1-R^2)$
1. Akaike Information Criteria: $AIC = 2k - 2\cdot\text{log-likelihood}$

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/nt6hKLSp3-8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

The code from the video is below. [PDF of chalk talk](static/chalk_talks/Lec09.pdf){target="_blank"}.


```{r, eval = FALSE, echo=TRUE, class.source="klippy"}
# Lec09 code ----------------
library(moderndive)
library(broom)


# Added on Tue 9/29 9:40am: Visualize both models
library(patchwork)
p1 <- ggplot(MA_schools, aes(x = perc_disadvan, y = average_sat_math, color = size)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    x = "Percent economically disadvantaged", y = "Math SAT Score",
    color = "School size", title = "Interaction model"
  ) +
  theme(legend.position = "none")
p2 <- ggplot(MA_schools,aes(x = perc_disadvan, y = average_sat_math, color = size)) +
  geom_point(alpha = 0.25) +
  geom_parallel_slopes(se = FALSE) +
  labs(
    x = "Percent economically disadvantaged", y = "Math SAT Score",
    color = "School size", title = "Parallel slopes model"
  ) +
  theme(axis.title.y = element_blank())
p1 + p2


# Fit parallel slopes model: Less complex
model_2_parallel_slopes <- 
  lm(average_sat_math ~ perc_disadvan + size, data = MA_schools)

# Fit interaction model: More complex
model_2_interaction <- 
  lm(average_sat_math ~ perc_disadvan * size, data = MA_schools)


# Updated on Tue 9/29 11am: Compare regression tables. Notice k = 4 vs k = 6
tidy(model_2_parallel_slopes, conf.int = TRUE)
tidy(model_2_interaction, conf.int = TRUE)


# Compare R^2_adj and AIC
glance(model_2_parallel_slopes)
glance(model_2_interaction)
```



## Class meeting time

1. Breakout rooms: Questions about
    1. Model Selection
    1. MP4 on R Packages
1. [Link](https://smith.zoom.us/rec/share/3lmr4qC3Fi8wBKBkrACavKQTuh5AFWkGuinXJpmrXYsAd9vpzxXuFXeq1NIEzbMl.hsPH0TZmkarqgrHy?startTime=1601387106000){target="_blank"} to video recording.



***



# Lec 08: Thu 9/24 {#Lec08}

## Videos

### 1. R Packages

Building a minimally viable R package based on the "R Packages" book [Chapter 2: The whole game](https://r-pkgs.org/whole-game.html){target="_blank"} and a little bit of [Chapter 14: External data](https://r-pkgs.org/data.html){target="_blank"}. [PDF of chalk talk](static/chalk_talks/Lec08.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/T7jLzGjfEEw" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

**Post-video update**: Recall from the end of the video that the reason the `check()` of the package failed was because the `man/toy_data.Rd` help file for the `toy_data` dataset did not get created. The reason is I misspelled the name of the dataset in `R/toy_data.R`:

```{r, echo=FALSE, fig.align="center", out.width="50%"}
include_graphics("static/images/toy_data.png")
```

This is a great lesson in the value of running `check()` often! Fix this by:

1. Fixing the above typo
1. Running `devtools::document()` to create the `man/toy_data.Rd` help file
1. Installing the package locally using `devtools::install()`
1. Checking the package using `devtools::check()`




## Class meeting time

1. Run this code to ensure the following packages are up-to-date: `install.packages(c("devtools", "roxygen2", "testthat", "knitr"))`
1. Announcements:
    1. Stick with lecture start time of 9:45, but we'll keep things moving briskly.
1. Breakout rooms:
    1. Discussion on Vogue article
    1. Other questions
1. Discuss what's next week
1. [Link](https://smith.zoom.us/rec/share/18_mdQR9-Lb_Z814FUVjgdeJRc1VX8BVXbCPnmiBDCh1TDnLU_y-8lPBrDRvc4CU.QOOyscB1PNLL2k8d?startTime=1600955111000){target="_blank"} to video recording.




## For next week

### 1. Readings

1. **Allen 2020**: If you haven't already, dedicate 30 minutes for a "done is better than perfect"
reading. Even if their are gaps in understanding, just encountering the terms and ideas for the first time will prime you for the next time.
1. **FPP3**: In particular the $y_t = S_t + T_t + R_t$ seasonal + trend + remainder breakdown of the $y_t$ US retail employment time series in [Figure 3.10](https://otexts.com/fpp3/classical-decomposition.html#fig:classical-empl){target="_blank"}.

```{r, echo = TRUE}
library(fpp3)
us_retail_employment <- us_employment %>%
  filter(year(Month) >= 1990, Title == "Retail Trade") %>%
  select(-Series_ID)

# Fit decomposition model
dcmp <- us_retail_employment %>%
  model(classical_decomposition(Employed, type = "additive"))

# Plot decomposition model
components(dcmp) %>% 
  autoplot() + 
  labs(x = "Year", title = "Employed = Trend + Seasonal + Remainder")
```


### 2. MP4 {#MP4}

For MP4, you will be adding one documented function, one documented dataset, and your `DESCRIPTION` info to the [`foofactors`](https://github.com/390-2020-09-Fall/foofactors){target="_blank"} package I demoed in the video. You are going to work in the following groups:

```{r}
set.seed(76)
students <- c("Candy", "Emma S.", "Emma K.", "Haley", "Lauren", "Olivia", "Serena", "Sophie", "Starry")
tibble(
  name = sample(students),
  Branch = rep(1:3, times = 3) %>% str_c("group", .),
  member = rep(1:3, each = 3) %>% str_c("Member ", .)
) %>% 
  pivot_wider(names_from = member, values_from = name)
```

You will

1. Each create branches from your group's branch. i.e. a branch of a branch.
1. Each independently work on your function, dataset, and `DESCRIPTION` file, being sure to `install()` and `check()` your package often. 
1. Create a pull request of your branch into the group's branch.
1. Request a *code review*: Member 1 requests a review from Member 2, 2 from 3, and 3 from 1.
1. Go back and forth about requested changes as necessary on the pull request page, just as I did for MP2. 
1. Once approved, Member 2 will merge Member 1's pull request into the group's branch.

Example: Lauren will

1. Create a branch `group1-lauren` from the `group1` branch.
1. Push/commit changes to the package to her `group1-lauren` branch, making sure to `install()` and `check()` her local version of the package often. 
1. Create a pull request of `group1-lauren` into `group1`
1. Tag Haley for a code review.
1. Incorporate changes requested by Haley (if any) 
1. Once approved, Haley will merge Lauren's pull request of the contents of the `group1-lauren` branch into the `group1` branch.


Notes:

1. Later on, we'll eventually merge the changes in the three group branches into `master`.
1. Expect [Oh shit, git!](https://wizardzines.com/zines/oh-shit-git/){target="_blank"} moments, especially *merge conflicts* in the `DESCRIPTION` file.



***



# Lec 07: Tue 9/22 {#Lec07}

## Videos

### 1. Filepaths

*Absolute* filepaths only work on your computer, thus making your work less reproducible. Using filepaths that are *relative* to some assumed *root* folder will work on anybody's computer. The `here` R package facilitates relative filepath use by always assuming the *root* folder is the folder of your RStudio Project. [PDF of chalk talk](static/chalk_talks/Lec07_filepaths.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/uR26lWqstBY" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>


### 2. Modeling interspecies competition

Two possible models for the effect of competition on the growth of a tree. Model 1 (in left image): Treating all competitor trees the same. Model 2 (in right image): Distinguishing competitor species. [PDF of chalk talk](static/chalk_talks/Lec07_competition.pdf){target="_blank"}.

```{r, echo=FALSE, out.width="49%", out.height="20%", fig.cap="Two models for the effect of competitor biomass.", fig.show='hold', fig.align='center'}
knitr::include_graphics(c("static/images/competition_1.png", "static/images/competition_2.png"))
``` 

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/FygAzz-JfOs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>


## Class meeting time

1. Announcements:
    1. If you haven’t already, please vote in the 3 Poll Everywhere questions posted in `#announcements` on Thursday 9/17.
    1. Starting today we'll be meeting in a dedicated Zoom room that automatically records. See Slack for new Zoom link.
1. Discuss updated Schedule above.
1. MP3: See [updated instructions](#MP3)
1. Breakout rooms
    1. Filepaths: A key step in ensuring reproducibility
    1. Two models for interspecies competition
1. Links to video recordings
    1. [Part 1](https://smith.zoom.us/rec/play/wNnTrm9S3JvHe_uAWkAXBVO_4n3-tnx8b9oSdCF-bwL7IQoC1RmWa7W1qPJNfttN8hgIqZP7wSMcZq4h.c_DXP_DZhlJFfrjg?autoplay=true&startTime=1600782173000){target="_blank"}
    1. [Part 2](https://smith.zoom.us/rec/share/Yt97lNdkNGvTC_Y6x-_hjCMwwAd8Udg9X6srdbGOGpxfxcEnAdSB5xiwoVcQIXbs.jW0nBSc_PYpKyHEO?startTime=1600783430000){target="_blank"}
1. **During office hours** A screencast of creating a minimally viable Shiny app using the MP3 starter code: Converting the histogram from base R to `ggplot2`. Enter usual lecture password below. 

<div style="position: relative; padding-bottom: 56.25%; height: 0;"><iframe src="https://www.loom.com/embed/bab813e2b831436c83a1cf07b094a1c3" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe></div>



***



# Lec 06: Thu 9/17 {#Lec06}

## Videos

### 1. Maximum likelihood estimation

Say you have data that consists of the following pairs of observations: diameter at breast height (dbh) as measured by your dendroband and day of year (doy) of the measurement. How we find the "best fitting" S-shaped curve through these points? In other words, how do we find the "optimal" values of the 5 parameters from the generalized logistic function? Also, what do we even by "best fitting"? [PDF of chalk talk](static/chalk_talks/Lec06.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/38H_QN3Z4SA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>



## Class meeting time

1. Set up today's Shiny app:
    1. Ensure you have the `shiny` package installed.
    1. Download and unzip this <a href="static/data/dendroband_shiny.zip" download>.zip file</a> of a Shiny application RStudio Project. Since this is an RStudio Project, you should not save it inside another RStudio Project
1. Set up Lec06 notes: Wherever it is you're saving lecture files/code
    1. Save the PDF of [A general model of intra-annual tree growth using
dendrometer bands by McMahon and Parker (2015)](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4314258/){target="_blank"} (open access).
    1. Copy the Lec06 code below as you did for the code in Lec03
1. Announcements:
    1. Please vote on three polls I posted in #announcements on Slack.
    1. Starting next week I'll have a dedicated zoom room for this class that auto-records. I will share link to zoom room on Slack before next lecture.
1. Breakout rooms:
    1. Get the values of the 5 parameters!
    1. Any questions?
1. [Link](https://smith.zoom.us/rec/share/gavffQ0QHbw7Z82trsHofxkysFZWRr3fCIEqWQlJD8I_dVJ3GnhgYUC7t2W8GbEb.o0fkIrER2h0VCgOg?startTime=1600350544000){target="_blank"} to video recording.

```{r, eval = FALSE, class.source="klippy"}
# Lec06 code ----------------
library(tidyverse)

dendroband_data <- read_csv("https://rudeboybert.github.io/SDS390/static/data/observed_dbh_vs_doy.csv")

# Plot data
base_plot <- ggplot() +
  geom_point(data = dendroband_data, mapping = aes(x = doy, y = dbh)) +
  labs(x = "day of year", y = "dbh")
base_plot


# Define the generalized logistic function. Note the params input has to be a
# vector of length 5 in the correct order:
lg5 <- function(params, doy) {
  # Get 5 parameter values
  L <- params[1]
  K <- params[2]
  doy.ip <- params[3]
  r <- params[4]
  theta <- params[5]
  
  # For specified 5 parameters and x = doy, compute y = dbh
  dbh <- L + ((K - L) / (1 + 1/theta * exp(-(r * (doy - doy.ip) / theta)) ^ theta))
  return(dbh)
}


# Let's set an initial guess and plot what the generalized logistic function
# looks like for this initial guess
K <- 12
L <- 14
doy.ip <- 100
r <- 0.05
theta <- 1
params_init <- c(K, L, doy.ip, r, theta)

# Not a great fit!
base_plot + 
  stat_function(fun = lg5, args = list(params = params_init), col = "red", n = 500)



# Let's define the "likelihood function" that we want to maximize/optimize. 
# Recall that this is our criteria for "best fitting" curve.
# These types of functions are covered in MTH 320 Mathematical Statistics
lg5_ML <- function(params, doy, dbh, resid.sd) {
  pred_dbh <- lg5(params, doy)
  pred_ML <- -sum(dnorm(dbh, pred_dbh, resid.sd, log = T))
  return(pred_ML)
}

# Numerical optimization via the optim() function:
lg5_optimization_output <- optim(
  # Our initial guess:
  par = params_init, 
  # The likelihood function we want to optimize:
  fn = lg5_ML, 
  # The points we want want to fit the S-shaped curve to:
  doy = dendroband_data$doy, dbh = dendroband_data$dbh,
  # Some extra stuff:
  resid.sd = 0.1, method = "BFGS", hessian = TRUE
  )
lg5_optimization_output

# The optimal (K*, L*, doy.ip*, r*, theta*) are saved in par
params_star <- lg5_optimization_output$par
params_star

# Let's plot what the generalized logistic function looks like for these optimal
# values. Not bad!
base_plot +
  stat_function(fun = lg5, args = list(params = params_star), col = "red", n = 500)
```



## For next week

### 1. Readings

1. **Allen 2020**: Dedicate 30 minutes for a "done is better than perfect"
reading **before** lecture
1. **R packages Ch2**: I suggest you follow along by running the code. You'll
need to do this eventually anyways.
1. **Vogue**: We're going to have a discussion on this article on Lec08 on Thu
9/24. This article was shared by my SCBI colleague [Erika
Gonzalez-Akre](https://sites.google.com/site/forestecoclimlab/people#h.p_ID_132){target="_blank"}

### 2. MP3 {#MP3}

Based on your MP2 work, create a Shiny app!

1. I will give feedback on MP2 via GitHub code review by tomorrow 5pm.
1. Consult
    1. The [Mastering Shiny](https://mastering-shiny.org/){target="_blank"}
    1. Shiny cheatsheet for the kinds of inputs you can create: RStudio
menu bar -> Help -> Cheatsheets -> Web apps with Shiny -> 1st page -> Right-hand
column
1. Create a new branch of the same repo as in MP2 and create a new pull request.
1. Criteria for app? Done is better than perfect.

I can't emphasize this enough: start simple, make a small incremental change and
test that it works, then make another small incremental change and test that
that works, and so on. If you make to large a change without testing, your app
will be harder to debug.

```{r, echo=FALSE, fig.align="center"}
include_graphics("static/images/MVP.png")
```

**Added on Tue 9/22**:

1. Submission instructions: Here is a template GitHub repo for [MP3](https://github.com/390-2020-09-Fall/shiny_app){target="_blank"}. However, unlike MP2 where you were an internal collaborator to the repo, here we are going to assume you are not a collaborator. Hence you will "fork" your own copy of the MP3 repo.
1. Start ultra simple, even if the interactive element isn't scientifically interesting.
1. Example workflow: Test early, test often.
    1. Get a non-interactive version of your plot working. I recommend you do this in a separate file, because debugging code in a Shiny app can get messy.
    1. Copy over code for non-interactive plot into your Shiny RStudio Project `app.R` file. *Test the app. If it works, commit your changes.*
    1. Add an input panel, but don't connect `input$` value to output plot yet. *Test the app. If it works, commit your changes.*
    1. Connect `input$` value to output plot. Test the app. *Test the app. If it works, commit your changes.*
    1. If you have time, iterate through the above steps. *Test the app. If it works, commit your changes.*



***



# Lec 05: Tue 9/15 {#Lec05}

## Videos

### 1. Models and parameter estimation

Given an assumed model $y = f(\vec{x}) + \epsilon$, you want an fitted model $\widehat{y} = \widehat{f}(\vec{x})$. To do this, you need to do *parameter estimation*. [PDF of chalk talk](static/chalk_talks/Lec05.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pAf1JAGzM-E" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>



## Class meeting time

1. Announcements
    1. Say hello to Emma K.
    1. In course schedule, I posted readings and lecture topics for next week (more on Thu 9/17).
    1. MP1: I'll give feedback by Thursday's lecture, likely this afternoon.
1. [Plan for the semester](https://docs.google.com/document/d/1PeQXPsnxe6ZJjiBGBXD3dRfTKNETKMQpzIJUSWgTYr0/edit?usp=sharing){target="_blank"}
1. Breakout rooms
    1. Plan for the semester and course format
    1. Video: model parameters
    1. MP2 questions
1. [Link](https://smith.zoom.us/rec/share/oRGM5exNswi3Svq6bfq3j3mxyYXzl2ELSTlGZ5RqIdQmkYOCl4cYDywpe6rLj8QO.lB4yeBtWJRZSv5C_?startTime=1600179202000){target="_blank"} to video recording.




***



# Lec 04: Thu 9/10 {#Lec04}

## Videos

### 1. GitHub branches and pull requests

Using the "playground" repo [here](https://github.com/390-2020-09-Fall/SCBI-ForestGEO-Data){target="_blank"}, which is a separate copy of the Smithsonian Conservation Biology Institute (SCBI) ForestGEO Data found [here](https://github.com/SCBI-ForestGEO/SCBI-ForestGEO-Data){target="_blank"}. [PDF of chalk talk](static/chalk_talks/Lec04.pdf).

**Update on Thu 9/10 8:30am**: I changed "ownership" of the repository from my personal GitHub "rudeboybert" to the class GitHub Organization ["390-2020-09-Fall"](https://github.com/390-2020-09-Fall). I've added a link to this organization in the top-left of this webpage menubar.


</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DHpNuxPgiQY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

### 2. Conducting a census of trees

In the Battell Woods, Middlebury, VT, USA.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/z3kNVHm7R0I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>



## Class meeting time

1. Announcements:
    1. See update I added today about Video 1. 
    1. For all video chalk talks, I'll post the PDF on the webpage. Also I'll work on improving my handwriting!
    1. Note that I added the two missing lines of code to the Lec03 code on auto-correlation functions.
1. Intros
1. Lingering questions from Lec03?
1. Breakout rooms:
    1. Questions about Lec04 Videos
    1. Data collection reflection: Write down anything that crossed your mind as you collected this data. Ex: what difficulties, what questions, did anything from my video not apply in your case?
    1. ForestGEO reading: What do you think are some organizational goals of the ForestGEO **network**?
1. Discuss what's next week.
1. [Link](https://drive.google.com/file/d/15vszRIZQ1qEpqiQbeXjJDApfDG-ZVQ2n/view?usp=sharing){target="_blank"} to video recording.


## For next week

### 1. Readings

The readings for next week are posted in the above Schedule Google Sheet. Anything below the orange line is still TBD.  

1. **Albert's tips for Shiny reading**: Run the code! The best way to learn how to use tools is to learn by doing.
1. **Albert's tips for Ecological Forecasting reading**: This book is pitched at a higher level than for undergraduates. However let's keep with the "some is better than none" philosophy by dedicating at least 30 minutes to reading and *setting a timer*.
    1. Read the synopsis at the start of each chapter
    1. Read the key concepts at the back of each chapter
    1. Scan through the figures and tables
    1. Most importantly tho, look at the clock and keep moving! *Done is better than perfect!*
    1. If you have more time or are more curious, then iterate through the above steps again, again, again, ...

```{r, echo=FALSE, fig.align="center"}
include_graphics("static/images/MVP.png")
```


### 2. MP2

Ask any questions in the `#mp2` channel on Slack.

**a) Race to the first data visualization** Create a first visualization of the 2018 SCBI ForestGEO census. For MP3, you'll be making a Shiny interactive version of this visualization.

1. Re-watch Lec04 Video 2 about tree censuses 
1. *"Numbers are numbers, but data has context"*: Look at map of the four corners of the [SCBI site](https://www.google.com/maps/d/edit?mid=1QYcZhzmRASjCqFyCiraxosBmMcWrEeg7&usp=sharing){target="_blank"}. 
1. Clone the playground version of the [SCBI-ForestGEO-Data](https://github.com/390-2020-09-Fall/SCBI-ForestGEO-Data) repo
1. Find the relevant `.csv` file in the `tree_main_census/` folder
1. Load the `.csv` in R


**b) Submit via GitHub branch and pull request**

1. Create a new branch just like in Lec04 Video 1.
1. Create your visualization in a file `390/YOURFIRSTNAME_YOURLASTNAME.Rmd`
1. Make all commits
1. Submit a pull request




***



# Lec 03: Tue 9/8 {#Lec03}

## Videos

### 1. Dendrobands

One way to measure a tree's dbh is using dendrobands (6:00). 

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OT2FPiMwGcQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

```{r, include = FALSE, eval = FALSE}
# Code used at end of video. Need to run
# growth_phenology/RScripts/SCBI_growth_phenology.R first
plot <- all_stems %>%
  as_tibble() %>%
  filter(tag %in% c(082422, 202215, 172202)) %>%
  mutate(sp = case_when(
    sp == "litu" ~ "tulip poplar",
    sp == "qual" ~ "white oak",
    sp == "quru" ~ "red oak"
  )) %>%
  unite("date", c(year, month, day), sep = "-") %>%
  mutate(date = ymd(date)) %>%
  filter(date >= ymd("2015-01-01")) %>%
  ggplot(aes(x=date, y=measure, col = sp, group = tag)) +
  geom_line() +
  labs(x = "Date of measurement", y = "Diameter in cm", col = "species") +
  coord_cartesian(xlim = c(ymd("2015-01-01"), ymd("2020-08-01")))
plot

library(plotly)
weather <- weatherdata %>%
  filter(DATE >= ymd("2015-01-01")) %>%
  mutate(month = floor_date(DATE, unit = "months")) %>%
  group_by(month) %>%
  dplyr::summarize(`Average max temp` = mean(TMAX)) %>%
  ggplot(aes(x = month, y = `Average max temp`)) +
  geom_line() +
  labs(x = "Date", y = "Temperature", title = "Average monthly maximum temperature")
ggplotly(weather)

plot +
  geom_vline(xintercept = as.Date("2017-07-01"), linetype = "dashed") +
  geom_vline(xintercept = as.Date("2020-07-01"), linetype = "dashed")
```


### 2. Time series {#Lec03-Video2}

Chalk talk on exploratory data analysis for time series plots (14:24). **Update after Lec03**: [PDF of chalk talk](static/chalk_talks/Lec03.pdf){target="_blank"}.

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oy-eVRkQUeE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>

Corresponding code:

```{r, eval = FALSE, class.source="klippy"}
# Lec03 Code
library(tidyverse)
library(tsibble)
library(lubridate)
library(fpp3)

weatherdata <-
  read_csv("https://rudeboybert.github.io/SDS390/static/data/NCDC_NOAA_precip_temp.csv") %>%
  mutate(
    # Convert to variable of type date
    date = dmy(DATE), 
    # This will be used for the group_by() below
    month = floor_date(date, unit = "month"),
    # Using special function from fpp package to define yearmonth units
    month = yearmonth(month)
  ) %>% 
  group_by(month) %>% 
  summarize(TMAX_avg = mean(TMAX, na.rm = TRUE), PRCP_avg = mean(PRCP, na.rm = TRUE)) %>% 
  # Convert to tsibble = time series tibble data type
  as_tsibble(index = month) 

# FPP3 2.2 Fig 2.1
weatherdata %>% autoplot(TMAX_avg)

# FPP3 2.4 Fig 2.4
weatherdata %>% gg_season(TMAX_avg, labels = "both")

# FPP3 2.5 Fig 2.5 
weatherdata %>% gg_subseries(TMAX_avg)

# FPP3 2.7 Fig 2.16 
weatherdata %>% gg_lag(TMAX_avg, lags = 1:12)

# Update after Lec03: FPP3 2.8 Fig 2.17
weatherdata %>% ACF(TMAX_avg) %>% autoplot()
```




## Class meeting time

1. Announcements
    1. More introductions: name/pronoun, year/major, city you're currently in, name a few things you will do this semester for self-care.
    1. Started scheduling office hours in [syllabus](syllabus.html).
    1. We'll be using the [3rd online edition of FPP](https://otexts.com/fpp3/){target="_blank"} (I originally linked to the 2nd edition).
1. Check in on [MP1](#MP1)
1. Set up our workspace for the semester:
    1. Open RStudio
    1. Create a new RStudio project called `SDS390`
    1. Create a new `.R` script or `.Rmd` and call it `lecture_notes`
    1. Copy the code for any lecture into `lecture_notes`. For today: the above `# Lec03 Code`
1. Breakout rooms: A designated group leader will create a Slack DM with all members, but not Albert. They will take notes and then speak on behalf of the group. Discuss
    1. What is the goal of analysis hinted in Video 1? Questions?
    1. Do you have questions about Video 2 on time series?
    1. Do you have any feedback/comments about lecture format?
    1. Questions about MP1?
1. [Link](https://smith.zoom.us/rec/share/msdCameUcJtJV4W6_TllvNOYGCYdU72iUSIFMPXxW0oF4zYv6G25uVGJdjHQ3BRb.MdQFuvpLLtgaxvUU){target="_blank"} to video recording.


***



# Lec 02: Thu 9/3 {#Lec02}

## Videos

Note: I will do my best to post any videos the day before lecture at 6pm eastern.

### 1. Data collection activity... in the field!

</br>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/U83hZCTRxPA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>
</br>


## Class meeting time

1. "Chalk talk": Introduction to GitHub terminology. I encourage you to write along: [*I’m not writing it down to remember it later, I’m writing it down to remember it now.*](https://twitter.com/jack/status/369882367093002242){target="_blank"}
1. Demo of what you'll be doing for MP1. 
1. [Link](https://smith.zoom.us/rec/share/r1TRECCVTK1AST0fjikBWNFziM1id-VtREbZM2mLsuv_sS4N5NkKCqrzOqh76BiS.cj7NMRvilB29J2yz){target="_blank"} to video recording.



## For next week

### 1. Readings

The readings for next week are posted in the above Schedule Google Sheet. Anything below the orange line is still TBD.  

1. To access all journal articles from Smith Libraries, you will need to be logged into Smith's Virtual Private Network [(instructions on how to set this up)](https://www.smith.edu/its/tara/networking/vpn.html){target="_blank"}. 
1. Tips on reading. Take the *minimally viable product* approach. In other words, a completed imperfect reading is better than an incomplete "perfect" reading.

```{r, echo=FALSE, fig.align="center"}
include_graphics("static/images/MVP.png")
```

    
### 2. MP1 {#MP1}

Ask any questions in the `#mp1` channel on Slack.

**a) Data collection**

1. To the best of your abilities, replicate my DBH data collection in the video.
1. You will submit your answers in this [Google Form](https://docs.google.com/forms/d/e/1FAIpQLSeJ28eWWThINaXKWE2uvOFuDL2YiMVPheSa47ZRrtp8Q10W1Q/viewform){target="_blank"}.
1. You may need help identifying the tree's species. To this end, take a few photos of the tree and if possible the leaves. 


**b) First GitHub edits**

1. Create an [ORCID](https://orcid.org/){target="_blank"}, which you can think of as a social security number for research. Mine is [0000-0001-7824-306X](https://orcid.org/0000-0001-7824-306X){target="_blank"}.
1. *Clone* the following *repo* *locally* onto your computer using RStudio: my *forked* copy of Prof. Ben Baumer's [`macleich` R package](https://github.com/rudeboybert/macleish){target="_blank"}. 
1. *Pull* the repo to update it with any changes.
1. Edit the `DESCRIPTION` file by adding yourself as a contributor like I did.
1. *Commit* your changes and then *push* them.
1. You may need to check out these [notes](https://rudeboybert.github.io/SDS192/PS.html#1_github_component){target="_blank"} on getting started linking GitHub to RStudio.



***



# Lec 01: Tue 9/1

## Class meeting time

1. Introductions: name, pronoun, year, major, city you're currently in, name a few things you will do this semester for self-care.
1. Announcement from the [Statistical & Data Sciences Coalition of Color (SDSCC)](https://docs.google.com/presentation/d/1trAXeX9FHCHiMk5iFTN14TEmK8tXbRHfY5WdmNGChVc/edit#slide=id.g93874104fe_0_5){target="_blank"}
1. Go over syllabus
1. What is forecasting? From [FPP 3.5](https://otexts.com/fpp2/prediction-intervals.html){target="_blank"}:
```{r, echo=FALSE}
include_graphics("https://otexts.com/fpp2/fpp_files/figure-html/googforecasts2-1.png")
```
1. Discussion topic: Name four variables about a tree that both (1) are easily measurable in the field while (2) capture the most information about it.
1. [Link](https://smith.zoom.us/rec/share/v8pUE6rz_HlIWLPo6huEQ594T9T-aaa81ikX-fVfz00jHE5Ns0-sumdQni9hSU2V){target="_blank"} to video recording (required password on Slack in `#announcements`).


## Videos

I will post a ~20min video lecture by Wednesday afternoon eastern time. This is why we are starting synchronous discussions 25 minutes later than scheduled. 

1. "Chalk talk" on GitHub. I encourage you to not just passively watch, but also actively write. [Field Notes'](https://fieldnotesbrand.com/){target="_blank"} slogan is *I'm not writing it down to remember it later, I'm writing it down to remember it now.*
1. Data collection activity... in the field!



***


